{{> header }}

<!-- Render Accounts table -->
<table id="accountsTable">
    <thead>
        <tr>
            <th>Account ID</th>
            <th>Name</th>
            <th>Balance</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {{#each rows}}
        <tr class="account-row" data-id="{{this.accountID}}" data-name="{{this.name}}" data-balance="{{this.balance}}">
            <td>{{this.accountID}}</td>
            <td>{{this.name}}</td>
            <td>{{this.balance}}</td>
            <td>
                <button class="edit-btn">Edit</button>
                <form action="/accounts/{{this.accountID}}?_method=DELETE" method="POST">
                    <button type="submit">Delete</button>
                </form>
            </td>
        </tr>
        {{/each}}
    </tbody>
</table>

<!-- Create Account Form -->
<form action="/accounts" method="POST">
    <label for="name">Name</label>
    <input type="text" id="name" name="name" required>
    <label for="balance">Balance</label>
    <input type="number" id="balance" name="balance" required>
    <button type="submit">Create Account</button>
</form>

<!-- Update Account Form -->
<form id="updateForm" action="/accounts/:id?_method=PUT" method="POST">
    <label for="updateName">Name</label>
    <input type="text" id="updateName" name="name" required>
    <label for="updateBalance">Balance</label>
    <input type="number" id="updateBalance" name="balance" required>
    <input type="hidden" id="accountId" name="id" required>
    <button type="submit">Update Account</button>
</form>

{{> footer }}

<!-- Client-side JavaScript for populating the update form -->
<script>
    const accountRows = document.querySelectorAll('.account-row');
    const updateForm = document.getElementById('updateForm');
    const updateName = document.getElementById('updateName');
    const updateBalance = document.getElementById('updateBalance');
    const accountId = document.getElementById('accountId');

    accountRows.forEach(row => {
        row.querySelector('.edit-btn').addEventListener('click', () => {
            accountId.value = row.dataset.id;
            updateName.value = row.dataset.name;
            updateBalance.value = row.dataset.balance;
            updateForm.action = `/accounts/${row.dataset.id}?_method=PUT`;
        });
    });
</script>
